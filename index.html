<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>メルカリ利益計算機 - iPhone風</title>
  <style>
    :root {
      --main-bg: #f5f5f7;
      --card-bg: #fff;
      --accent: #007aff;
      --input-bg: #f2f2f7;
      --border: #dadada;
      --shadow: 0 2px 8px rgba(70,80,110,0.07);
      --radius: 18px;
      --title: #1c1c1e;
      --label: #7a7a85;
      --profit-pos: #28b14a;
      --profit-neg: #fa3a2f;
      --field-border: #eaecf1;
      --input-color: #161617;
    }

    body {
      background: var(--main-bg);
      min-height: 100vh;
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans JP', 'Yu Gothic', 'Meiryo', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-bottom: 2rem;
    }

    /* 水色→青 グラデーションヘッダー */
    .site-header {
      width: 100%;
      background: linear-gradient(135deg, #67d4f5 0%, #38bdf8 35%, #0ea5e9 65%, #2563eb 100%);
      padding: 2rem 1rem 2.25rem;
      box-sizing: border-box;
      text-align: center;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
    }
    .site-header .header-title {
      margin: 0;
      font-size: clamp(1.35rem, 4.5vw, 1.75rem);
      font-weight: 700;
      color: #fff;
      letter-spacing: 0.08em;
      line-height: 1.3;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
    }
    .site-header .header-subtitle {
      margin: 0.6rem 0 0;
      font-size: clamp(0.8rem, 2.5vw, 0.95rem);
      font-weight: 500;
      color: rgba(255, 255, 255, 0.95);
      line-height: 1.5;
      max-width: 360px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 12px;
      box-sizing: border-box;
      letter-spacing: 0.03em;
    }
    @media (max-width: 480px) {
      .site-header {
        padding: 1.5rem 12px 1.75rem;
      }
      .site-header .header-title {
        letter-spacing: 0.05em;
      }
      .site-header .header-subtitle {
        padding: 0 8px;
        font-size: 0.8rem;
      }
    }

    .container {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      max-width: 410px;
      width: 100vw;
      margin: -20px auto 0;
      padding: 22px 22px 15px 22px;
      box-sizing: border-box;
      position: relative;
      z-index: 1;
    }
    .calc-title {
      text-align: center;
      color: var(--accent);
      font-weight: 600;
      font-size: 1.2em;
      letter-spacing: 1px;
      margin-bottom: 1em;
      margin-top: 0.4em;
    }
    .fields {
      margin-top: 0.7em;
    }
    .row {
      display: flex;
      align-items: center;
      margin-bottom: 1.18em;
    }
    .row label {
      flex: 0 0 80px;
      font-size: 1.04em;
      color: var(--label);
      font-weight: 500;
      letter-spacing: 1px;
    }
    .row input, 
    .row select {
      flex: 1 1 auto;
      font-size: 1.11em;
      padding: 9px 12px;
      border: 1.4px solid var(--field-border);
      border-radius: 11px;
      background: var(--input-bg);
      color: var(--input-color);
      transition: border 0.2s;
      margin-left: 10px;
      box-sizing: border-box;
      outline-color: var(--accent);
    }
    .row select {
      min-width: 0;
      cursor: pointer;
    }
    .fee-preview {
      border-radius: 10px;
      padding: 9px 10px 8px 10px;
      background: #f2f2f7;
      margin-left: 10px;
      border: 1.1px solid #e7eaf2;
      font-size: 1.07em;
      color: #5984be;
      min-width: 0;
    }
    .result-box {
      background: #f7f8fa;
      border-radius: 15px;
      border: 1.1px solid #e6e6ee;
      margin-top: 26px;
      padding: 24px 13px 17px;
      text-align: center;
      box-shadow: 0 4px 9px rgba(109,124,200,0.04);
    }
    .profit {
      font-size: 1.55em;
      margin-bottom: 0.14em;
      font-variant-numeric: tabular-nums;
      font-weight: 600;
    }
    .profit.positive {
      color: var(--profit-pos);
      text-shadow: 0 1px 4px #addcbf44;
    }
    .profit.negative {
      color: var(--profit-neg);
      text-shadow: 0 1px 4px #f9bcbc33;
    }
    .margin-label, .result-label {
      display: block;
      color: #55647a;
      font-size: 1em;
      margin-bottom: 0;
      font-weight: 500;
    }
    .margin-value {
      font-size: 1.08em;
      font-variant-numeric: tabular-nums;
      color: var(--accent);
      font-weight: bold;
      margin-bottom: 0.7em;
    }
    footer {
      margin-top: 22px;
      text-align: right;
      font-size: 0.96em;
      color: #b0b3bb;
    }
    @media (max-width: 480px) {
      .container { max-width: 99vw; padding: 18px 5vw;}
      .row label {flex-basis: 80px;}
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type="number"] { -moz-appearance: textfield; appearance: textfield; }

    /* 読み物セクション（AdSense審査向け） */
    .article-wrap {
      max-width: 720px;
      width: 100%;
      padding: 0 16px;
      margin-top: 32px;
      box-sizing: border-box;
    }
    .article-section {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 24px 32px;
      box-sizing: border-box;
    }
    .article-section .section-title {
      font-size: 1.35rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 3px solid var(--accent);
      line-height: 1.4;
      text-align: center;
      background: linear-gradient(90deg, #0d4d2b 0%, #1b5e3f 40%, #388e3c 70%, #7cb342 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .article-section .section-lead {
      font-size: 0.95rem;
      color: var(--label);
      margin-bottom: 1.75rem;
      line-height: 1.85;
    }
    .article-section .tip-heading {
      font-size: 1.1rem;
      color: var(--accent);
      margin: 1.6rem 0 0.7rem;
      padding-left: 0.75rem;
      border-left: 4px solid var(--accent);
      font-weight: 600;
      line-height: 1.45;
    }
    .article-section .tip-heading:first-of-type { margin-top: 0; }
    .article-section .sub-heading {
      font-size: 1rem;
      color: var(--title);
      margin: 1.2rem 0 0.5rem;
      font-weight: 600;
    }
    .article-section p {
      margin-bottom: 1rem;
      font-size: 0.95rem;
      color: var(--title);
      line-height: 1.8;
    }
    .article-section ul {
      margin: 0.75rem 0 1rem 1.5rem;
      font-size: 0.95rem;
      color: var(--title);
      line-height: 1.75;
    }
    .article-section li { margin-bottom: 0.35rem; }
    .article-section .tip-num {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      width: 1.5rem;
      height: 1.5rem;
      line-height: 1.5rem;
      text-align: center;
      border-radius: 50%;
      font-size: 0.8rem;
      font-weight: 700;
      margin-right: 0.4rem;
    }
    .article-section .closing {
      margin-top: 1.5rem;
      padding: 1rem 1.1rem;
      background: var(--input-bg);
      border-radius: 12px;
      font-size: 0.9rem;
      color: var(--label);
      line-height: 1.75;
    }
    .article-section .closing strong { color: var(--title); }
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <h1 class="header-title">メルカリ利益計算機</h1>
    <p class="header-subtitle">出品価格・手数料・送料から、手取り利益を簡単に計算</p>
  </header>
  <div class="container">
    <h2 class="calc-title">利益を計算する</h2>
    <div class="fields">
      <div class="row">
        <label for="price">売上</label>
        <input type="number" id="price" min="1" step="1" placeholder="金額">
      </div>
      <div class="row">
        <label for="fee">手数料</label>
        <span id="fee-value" class="fee-preview">-</span>
      </div>
      <div class="row">
        <label for="shipping">送料</label>
        <select id="shipping">
          <optgroup label="【らくらくメルカリ便】">
            <option value="210">ネコポス ¥210</option>
            <option value="520">宅急便コンパクト (¥450+BOX¥70) ¥520</option>
            <option value="750">宅急便 60サイズ ¥750</option>
            <option value="850">宅急便 80サイズ ¥850</option>
            <option value="1050">宅急便 100サイズ ¥1,050</option>
          </optgroup>
          <optgroup label="【ゆうゆうメルカリ便】">
            <option value="230">ゆうパケット ¥230</option>
            <option value="220">ゆうパケットポスト (¥215+シール¥5) ¥220</option>
            <option value="520">ゆうパケットプラス (¥455+BOX¥65) ¥520</option>
            <option value="770">ゆうパック 60サイズ ¥770</option>
            <option value="870">ゆうパック 80サイズ ¥870</option>
          </optgroup>
          <optgroup label="【その他】">
            <option value="custom">普通郵便/定形外 (手入力)</option>
            <option value="0">無料(送料なし)</option>
          </optgroup>
        </select>
        <input type="number" id="shipping-custom" placeholder="直接入力" min="0" style="display:none; width:120px; margin-left:8px;">
      </div>
    </div>
    <div class="result-box" id="result">
      <span class="result-label">利益</span>
      <div class="profit positive" id="profit">-</div>
      <span class="margin-label">利益率</span>
      <div class="margin-value" id="margin">-</div>
    </div>
    <footer>
      ⓒ Mercari 利益計算
    </footer>
  </div>

  <section class="article-wrap" aria-label="読み物">
    <article class="article-section" id="tips">
      <h1 class="section-title">『メルカリで利益を最大化する5つのコツ』</h1>
      <p class="section-lead">
        メルカリで出品を始めたばかりの方や、もう少し利益を伸ばしたい方に向けて、実践しやすい5つのポイントをまとめました。手数料や送料を理解したうえで、出品の質を高めていくことが収益アップの近道です。
      </p>

      <h2 class="tip-heading"><span class="tip-num">1</span>利益の計算を習慣にする</h2>
      <p>
        メルカリでは、出品価格がそのまま手元に残るわけではありません。販売手数料（出品価格の約10％）や、送料を誰が負担するかによって、実際の利益は大きく変わります。特に「送料込み」で出品する場合は、送料分を差し引いたうえで、さらに手数料がかかることを忘れがちです。
      </p>
      <p>
        このページの計算機を使って、出品前に「いくら手元に残るか」を必ず確認する習慣をつけましょう。採算が合わない価格での出品を防ぎ、無駄な赤字を減らすことができます。
      </p>

      <h2 class="tip-heading"><span class="tip-num">2</span>写真と説明で「買いたい」と思わせる</h2>
      <h3 class="sub-heading">写真のポイント</h3>
      <p>
        1枚目は商品が一目で分かる明るい写真にします。複数枚使える場合は、傷や汚れがある部分も正直に写し、購入後のトラブルを防ぎましょう。背景を整え、スマートフォンでも見やすいサイズで撮影することが大切です。
      </p>
      <h3 class="sub-heading">説明文のポイント</h3>
      <p>
        商品名には、ブランド名・品名・色・サイズなど、検索でヒットしやすいキーワードを入れます。説明文では、使用感・付属品の有無・注意点を具体的に書くことで、問い合わせが減り、スムーズな取引につながります。
      </p>

      <h2 class="tip-heading"><span class="tip-num">3</span>相場を調べて適正価格で出品する</h2>
      <p>
        同じような商品がいくらで売れているか、メルカリの「相場検索」や「売れた商品」の価格を参考にしましょう。高すぎると売れ残り、安すぎると利益が減ります。商品の状態（未使用・美品・中古など）に合わせた価格設定が、利益を最大化するコツです。
      </p>
      <p>
        定価や新品価格だけで決めず、「今のメルカリでいくらで落ち着いているか」を確認してから値付けすることが重要です。
      </p>

      <h2 class="tip-heading"><span class="tip-num">4</span>送料設定を戦略的に選ぶ</h2>
      <p>
        送料を「出品者負担」にするか「購入者負担」にするかで、売れ行きと利益のバランスが変わります。出品者負担にすると購入者のハードルが下がり、売れやすくなる反面、送料分だけ利益が減ります。反対に、購入者負担にすると利益は守りやすい一方で、価格が高く見えることがあります。
      </p>
      <p>
        らくらくメルカリ便やゆうゆうメルカリ便の料金を把握したうえで、商品の価格帯や重さ・サイズに応じて、どちらが総合的に得になるかを計算してから選ぶと、利益を最大化しやすくなります。
      </p>

      <h2 class="tip-heading"><span class="tip-num">5</span>評価とスピード対応を大切にする</h2>
      <p>
        良い評価が集まると、購入者が安心して取引してくれやすくなります。発送はできるだけ早く行い、丁寧な梱包と正確な発送連絡を心がけましょう。コメントへの返信も早めに行うと、信頼感が増します。
      </p>
      <p>
        問題が起きたときは、感情的にならず、ルールに沿って冷静に対応することが、長くメルカリで利益を出し続けるための土台になります。
      </p>

      <div class="closing">
        <strong>まとめ</strong><br>
        利益計算を習慣にし、写真・説明・価格・送料・評価の5つを意識することで、メルカリでの収益を無理なく伸ばしていけます。まずは上の計算機で手取りを確認しつつ、少しずつ出品の質を高めていきましょう。
      </div>
    </article>
  </section>

  <script>
      // 要素の取得
      const priceEl = document.getElementById('price');
      const feeEl = document.getElementById('fee-value');
      const shippingEl = document.getElementById('shipping');
      const shippingCustomEl = document.getElementById('shipping-custom');
      const profitEl = document.getElementById('profit');
      const marginEl = document.getElementById('margin');

      // 保存読み込み
      function restoreLocalStorage() {
        const price = localStorage.getItem('mercari_price');
        const shipping = localStorage.getItem('mercari_shipping');
        const shippingCustom = localStorage.getItem('mercari_shipping_custom');
        if (price !== null) priceEl.value = price;
        if (shipping !== null) shippingEl.value = shipping;
        if (shippingCustom !== null) shippingCustomEl.value = shippingCustom;
      }

      restoreLocalStorage();

      function saveLocalStorage() {
        localStorage.setItem('mercari_price', priceEl.value);
        localStorage.setItem('mercari_shipping', shippingEl.value);
        localStorage.setItem('mercari_shipping_custom', shippingCustomEl.value);
      }

      function getNumberInputValue(el) {
        // 入力欄が空、null、または数値以外 → 0
        const val = el.value;
        if (val === "" || val === null || isNaN(val)) return 0;
        return Number(val);
      }

      // 送料値の汎用取得
      function getShippingValue() {
        if (shippingEl.value === "custom") {
          return getNumberInputValue(shippingCustomEl);
        } else {
          // select の value（数値文字列）→ Numberへ
          const selVal = shippingEl.value;
          if (selVal === "" || selVal === null || isNaN(selVal)) return 0;
          return Number(selVal);
        }
      }

      // 計算
      function calc() {
        // すべての値を0デフォルトにして取得
        const price = getNumberInputValue(priceEl);
        // 手入力送料
        const shipping = getShippingValue();

        // 手数料10%で小数切り捨て
        let fee = Math.floor(price * 0.10);
        feeEl.textContent = price ? `¥${fee.toLocaleString()}` : '-';

        // NaN防止
        let profit = price - fee - shipping;
        if (isNaN(profit)) profit = 0;
        let margin = (price > 0) ? (profit / price * 100) : 0;

        // 利益・利益率表示
        if (!price) {
          profitEl.textContent = '-';
          marginEl.textContent = '-';
          profitEl.classList.remove('negative','positive');
          profitEl.classList.add('positive');
          return;
        }
        profitEl.textContent = `¥${profit.toLocaleString()}`;
        marginEl.textContent = `${margin.toFixed(1)}%`;

        // 色分け
        profitEl.classList.remove('positive', 'negative');
        if(profit>=0){
          profitEl.classList.add('positive');
        } else {
          profitEl.classList.add('negative');
        }
        saveLocalStorage();
      }

      // 送料選択で切り替え・リアルタイム計算
      function handleShippingChange() {
        if (shippingEl.value === "custom") {
          shippingCustomEl.style.display = "inline-block";
          // 入力非活性→活性
          shippingCustomEl.disabled = false;
          setTimeout(()=>shippingCustomEl.focus(), 100);
        } else {
          shippingCustomEl.style.display = "none";
          shippingCustomEl.value = ""; // 値リセット
          shippingCustomEl.disabled = true;
        }
        calc();
      }

      // イベント登録
      priceEl.addEventListener('input', calc);
      shippingEl.addEventListener('change', handleShippingChange);
      shippingCustomEl.addEventListener('input', calc);

      // ページロード時: 初期値0で一度計算
      window.addEventListener('DOMContentLoaded', () => {
        if (priceEl.value === "") priceEl.value = 0;
        // shipping selectは数値初期値、空なら210で初期化
        if (shippingEl.value === "" || shippingEl.value === null) shippingEl.value = "210";
        // shipping custom入力欄は0
        if (shippingCustomEl.value === "") shippingCustomEl.value = 0;
        // カスタム選択時の表示初期化
        if (shippingEl.value === "custom") {
          shippingCustomEl.style.display = "inline-block";
          shippingCustomEl.disabled = false;
        } else {
          shippingCustomEl.style.display = "none";
          shippingCustomEl.disabled = true;
        }
        calc();
      });
    </script>
</body>
</html>